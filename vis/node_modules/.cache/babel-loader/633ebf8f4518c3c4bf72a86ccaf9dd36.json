{"ast":null,"code":"var _jsxFileName = \"F:\\\\D3\\\\2019\\u6D59\\u5927\\u6691\\u671F\\u5B66\\u4E60\\\\SummerCourse2019-master\\\\SummerCourse2019-master\\\\vis\\\\src\\\\snapshots.jsx\";\nimport React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport { rgb } from \"d3-color\";\n\nclass Snapshots extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      grahfi: null\n    };\n  }\n\n  componentWillReceiveProps(props) {\n    const snapshots = props.snapshots;\n    const snapshotSVG = d3.select(\"#snapshot\");\n    const padding = 100;\n    const width = snapshotSVG.node().parentNode.clientWidth;\n    snapshotSVG.attr(\"width\", width).attr(\"height\", width).attr(\"fill\", \"black\");\n    const max = {};\n    const min = {};\n    max.x = d3.max(snapshots, snpst => snpst.vector[0]);\n    max.y = d3.max(snapshots, snpst => snpst.vector[1]);\n    min.x = d3.min(snapshots, snpst => snpst.vector[0]);\n    min.y = d3.min(snapshots, snpst => snpst.vector[1]);\n    /* var legendSVG = d3.select(\"#legend\")\n    legendSVG.append('g');\n    var line = legendSVG.append('line')\n        .attr('x1', 0)\n        .attr('y1', 2)\n        .attr('x2', 15)\n        .attr('y2', 2)\n        //.attr('stroke', sp[index])\n        .attr('stroke-width', 5);\n    var text = legendSVG.append('text')\n        .attr('class', 'legend-label')\n        .attr(\"dy\", -13)\n        .style(\"text-anchor\", \"start\")\n        //.text(\"data\" + index)\n        .attr('fill', \"Black\")\n        .attr('font-size', '13')\n        .attr(\"transform\", \"translate(\" + 18 + \",\" + 20 + \")\");    */\n\n    var legend = svg.append(\"g\").attr(\"class\", \"legend\").attr(\"x\", w - 65).attr(\"y\", 25).attr(\"height\", 100).attr(\"width\", 100);\n    legend.append(\"rect\").attr(\"x\", w - 65).attr(\"y\", 25).attr(\"width\", 10).attr(\"height\", 10).style(\"fill\", function (d) {\n      return color_hash[dataset.indexOf(d)][1];\n    });\n    legend.append(\"text\").attr(\"x\", w - 65).attr(\"y\", 25).text(function (d) {\n      return color_hash[dataset.indexOf(d)][0] + \": \" + d;\n    });\n    const xScale = d3.scaleLinear().domain([min.x, max.x]).range([padding, width - padding]);\n    const yScale = d3.scaleLinear().domain([min.y, max.y]).range([padding, width - padding]);\n    const snapshotLinkData = [];\n\n    for (let i = 0; i < snapshots.length - 1; i++) {\n      snapshotLinkData.push([snapshots[i].vector, snapshots[i + 1].vector]);\n    }\n\n    const snapshotLink = snapshotSVG.selectAll(\"line\").data(snapshotLinkData);\n    snapshotLink.exit().remove();\n    snapshotLink.enter().append(\"line\").attr(\"x1\", d => xScale(d[0][0])).attr(\"x2\", d => xScale(d[1][0])).attr(\"y1\", d => yScale(d[0][1])).attr(\"y2\", d => yScale(d[1][1])).attr(\"stroke\", \"#d9dde2\").attr(\"stroke-width\", 3);\n    const pointsData = snapshots.map(snpst => snpst.vector);\n    const points = snapshotSVG.selectAll(\"circle\").data(pointsData);\n    points.exit().remove();\n    points.enter().append(\"circle\").attr(\"cx\", d => xScale(d[0])).attr(\"cy\", d => yScale(d[1])).attr(\"r\", 5).attr(\"fill\", function (data, i) {\n      if (i < 100) {\n        return \"rgb(80,255,\" + (255 - i * 2) + \")\";\n      } else {\n        return \"rgb(80,\" + (255 - i * 2 + 200) + \",0)\";\n      }\n    }).attr(\"stroke\", function (data, i) {\n      if (i < 100) {\n        return \"rgb(80,255,\" + (255 - i * 2) + \")\";\n      } else {\n        return \"rgb(80,\" + (255 - i * 2 + 200) + \",0)\";\n      }\n    }).on(\"click\", (d, i) => {\n      this.setState({\n        grahfi: i\n      }); // console.log(this.state.grahfi)\n      //console.log(d, i);\n    });\n  }\n\n  render() {\n    return React.createElement(\"svg\", {\n      id: \"snapshot\",\n      onClick: // console.log(this.state.grahfi),\n      this.props.news.getChildData.bind(this, this.state.grahfi),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    });\n  }\n\n}\n\nexport default Snapshots;","map":{"version":3,"sources":["F:\\D3\\2019浙大暑期学习\\SummerCourse2019-master\\SummerCourse2019-master\\vis\\src\\snapshots.jsx"],"names":["React","Component","d3","rgb","Snapshots","constructor","props","state","grahfi","componentWillReceiveProps","snapshots","snapshotSVG","select","padding","width","node","parentNode","clientWidth","attr","max","min","x","snpst","vector","y","legend","svg","append","w","style","d","color_hash","dataset","indexOf","text","xScale","scaleLinear","domain","range","yScale","snapshotLinkData","i","length","push","snapshotLink","selectAll","data","exit","remove","enter","pointsData","map","points","on","setState","render","news","getChildData","bind"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\"\nimport * as d3 from \"d3\"\nimport { rgb } from \"d3-color\";\n\nclass Snapshots extends Component {\n    constructor(props) {\n        super(props)\n        this.state={\n            grahfi:null,\n        }\n    }\n\n    componentWillReceiveProps(props) {\n        const snapshots = props.snapshots\n        const snapshotSVG = d3.select(\"#snapshot\")\n        const padding = 100\n        const width = snapshotSVG.node().parentNode.clientWidth\n        snapshotSVG.attr(\"width\", width).attr(\"height\", width).attr(\"fill\",\"black\")\n        const max = {}\n        const min = {}\n        max.x = d3.max(snapshots, snpst => snpst.vector[0])\n        max.y = d3.max(snapshots, snpst => snpst.vector[1])\n        min.x = d3.min(snapshots, snpst => snpst.vector[0])\n        min.y = d3.min(snapshots, snpst => snpst.vector[1])\n    /* var legendSVG = d3.select(\"#legend\")\n    legendSVG.append('g');\n    var line = legendSVG.append('line')\n        .attr('x1', 0)\n        .attr('y1', 2)\n        .attr('x2', 15)\n        .attr('y2', 2)\n        //.attr('stroke', sp[index])\n        .attr('stroke-width', 5);\n    var text = legendSVG.append('text')\n        .attr('class', 'legend-label')\n        .attr(\"dy\", -13)\n        .style(\"text-anchor\", \"start\")\n        //.text(\"data\" + index)\n        .attr('fill', \"Black\")\n        .attr('font-size', '13')\n        .attr(\"transform\", \"translate(\" + 18 + \",\" + 20 + \")\");    */          \n      \n        var legend = svg.append(\"g\")\n\t  .attr(\"class\", \"legend\")\n\t  .attr(\"x\", w - 65)\n\t  .attr(\"y\", 25)\n\t  .attr(\"height\", 100)\n\t  .attr(\"width\", 100);\n\n\tlegend.append(\"rect\")\n\t  .attr(\"x\", w - 65)\n\t  .attr(\"y\", 25)\n\t  .attr(\"width\", 10)\n\t  .attr(\"height\", 10)\n\t  .style(\"fill\", function(d) { return color_hash[dataset.indexOf(d)][1] });\n\n\tlegend.append(\"text\")\n\t  .attr(\"x\", w - 65)\n\t  .attr(\"y\", 25)\n\t  .text(function(d) { return color_hash[dataset.indexOf(d)][0] + \": \" + d; });\n\n        const xScale = d3\n            .scaleLinear()\n            .domain([min.x, max.x])\n            .range([padding, width - padding])\n        const yScale = d3\n            .scaleLinear()\n            .domain([min.y, max.y])\n            .range([padding, width - padding])\n\n        const snapshotLinkData = []\n        for (let i = 0; i < snapshots.length - 1; i++) {\n            snapshotLinkData.push([\n                snapshots[i].vector,\n                snapshots[i + 1].vector\n            ])\n        }\n        const snapshotLink = snapshotSVG\n            .selectAll(\"line\")\n            .data(snapshotLinkData)\n        snapshotLink.exit().remove()\n        snapshotLink\n            .enter()\n            .append(\"line\")\n            .attr(\"x1\", d => xScale(d[0][0]))\n            .attr(\"x2\", d => xScale(d[1][0]))\n            .attr(\"y1\", d => yScale(d[0][1]))\n            .attr(\"y2\", d => yScale(d[1][1]))\n            .attr(\"stroke\", \"#d9dde2\")\n            .attr(\"stroke-width\", 3)\n\n        const pointsData = snapshots.map(snpst => snpst.vector)\n        const points = snapshotSVG.selectAll(\"circle\").data(pointsData)\n        points.exit().remove()\n        points\n            .enter()\n            .append(\"circle\")\n            .attr(\"cx\", d => xScale(d[0]))\n            .attr(\"cy\", d => yScale(d[1]))\n            .attr(\"r\", 5)\n            .attr(\"fill\", function(data,i){\n                if(i < 100){ return \"rgb(80,255,\"+(255 - i*2)+\")\";}\n                else{return \"rgb(80,\"+(255 - i*2 +200)+\",0)\";}\n            })\n            .attr(\"stroke\",function(data,i){\n                if(i < 100){ return \"rgb(80,255,\"+(255 - i*2)+\")\";}\n                else{return \"rgb(80,\"+(255 - i*2 + 200)+\",0)\";}\n                \n            })\n            .on(\"click\", (d, i) => {\n                this.setState({\n                    grahfi:i,\n                });\n                // console.log(this.state.grahfi)\n                //console.log(d, i);\n\n            })\n            \n\n    \n    }\n    render() {\n        return <svg id=\"snapshot\" onClick={\n                // console.log(this.state.grahfi),\n                this.props.news.getChildData.bind(this,this.state.grahfi)\n        }\n        />\n    }\n}\n\nexport default Snapshots\n"]},"metadata":{},"sourceType":"module"}